<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Settings – File Reporter 2</title>
  <link rel="stylesheet" href="/static/app.css" />
</head>
<body>
  <header>
    <h1>Settings</h1>
    <a href="/">← Back</a>
  </header>

  <section>
    <h2>Google Sheets</h2>
    <form id="settingsForm">
      <div class="row">
        <label>Sheet Name
          <input type="text" id="sheetName" required />
        </label>
      </div>
      <div class="row">
        <label>Service Account JSON
          <input type="file" id="saJson" accept="application/json" />
        </label>
      </div>

      <!-- <h2>Paths</h2>
      <div class="row">
        <label>Repo Folder
          <input type="text" id="repoDir" placeholder="/repo" />
        </label>
      </div>
      <div class="row">
        <label>Show Media Folder
          <input type="text" id="showMediaDir" placeholder="/repo_show" />
        </label>
      </div>
      <div class="row">
        <label>Quarantine Folder
          <input type="text" id="quarantineDir" placeholder="/repo_quarantine" />
        </label>
      </div> -->

      <button type="submit">Save Settings</button>
    </form>
  </section>

  <script>
    async function loadSettings(){
      const res = await fetch('/api/settings');
      const cfg = await res.json();
      document.getElementById('sheetName').value = cfg.sheet_name || '';
      document.getElementById('repoDir').value = cfg.repo_dir || '';
      document.getElementById('showMediaDir').value = cfg.show_media_dir || '';
      document.getElementById('quarantineDir').value = cfg.quarantine_dir || '';
    }
    document.getElementById('settingsForm').addEventListener('submit', async (e)=>{
      e.preventDefault();
      const fd = new FormData();
      fd.append('sheet_name', document.getElementById('sheetName').value);
      fd.append('repo_dir', document.getElementById('repoDir').value);
      fd.append('show_media_dir', document.getElementById('showMediaDir').value);
      fd.append('quarantine_dir', document.getElementById('quarantineDir').value);
      const file = document.getElementById('saJson').files[0];
      if (file) fd.append('sa_json', file, 'google-service-account.json');
      const res = await fetch('/api/settings', { method:'POST', body: fd });
      const out = await res.json();
      alert(out.error || 'Saved!');
    });
    loadSettings();
  </script>
</body>
</html>